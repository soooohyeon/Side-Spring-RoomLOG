<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RoomLOG</title>
  <link rel="shortcut icon" th:href="@{/image/layout/favicon.png}">
  <link rel="stylesheet" th:href="@{/css/layout/main-layout.css}">
  <link rel="stylesheet" th:href="@{/css/community/community-view.css}">
  <script src="http://code.jquery.com/jquery-latest.min.js"></script>
  <th:block th:if="${session.userId != null} and ${session.userId != -1}">
    <!-- 로그인 상태면 유저 번호 sessionStorage에 저장 -->
    <script th:inline="javascript">
      sessionStorage.setItem("userId", [[${session.userId}]]);
    </script>
  </th:block>
  <th:block th:unless="${session.userId != null} and ${session.userId != -1}">
    <script th:inline="javascript">
      sessionStorage.removeItem("userId");
    </script>
  </th:block>
  <script defer th:src="@{/js/basic/basic.js}"></script>
  <script defer th:src="@{/js/community/community-view.js}"></script>
  <script defer type="module" th:src="@{/js/module/comment.js}"></script>
  <script defer type="module" th:src="@{/js/community/community-comment.js}"></script>
</head>
<body>
  <!-- 상단 공통 헤더 영역 -->
  <header id="HEADER-CONTAINER">
	<div th:replace="layout/user-header-login :: headerLoginFragment"></div>
	<div th:replace="layout/user-header-menu :: headerMenuFragment"></div>
  </header>
  <!--  -->
  
  <!-- 메인 콘텐츠 영역 -->
  <main id="MAIN-CONTAINTER">

    <!-- 글 정보 출력 영역 -->
    <section class="section-line">
      <div id="DIV-POST-PROFILE-WRAP">

        <!-- 글 내용 출력 영역 -->
        <div id="DIV-POST-WRAP">
          <div id="DIV-POST-TITLE" th:text="${post.communityTitle}"></div>
          <div id="DIV-DATE-BTN-WRAP">
            <!-- 등록 / 수정 날짜 -->
            <div id="DIV-DATE-WRAP">
              <div>
                <span>등록일</span>
                <span class="time-ago" th:data-timestamp="${post.createDate}"></span>
              </div>
              <div id="DIV-UPDATE-WRAP" th:if="${post.createDate != post.modifiedDate}">
                <span>수정일</span>
                <span class="time-ago" th:data-timestamp="${post.modifiedDate}"></span>
              </div>
            </div>

            <!-- 수정 / 삭제 버튼 -->
            <div id="DIV-BTN-WRAP" th:if="(${session.userId} != null) and (${post.userId} == ${session.userId.longValue()})">
              <div class="div-post-btn div-menu-line">
                <span th:onclick="|location.href='@{/community/community-edit}?communityId=${post.communityId}'|">수정</span>
              </div>
              <div class="div-post-btn">
                <span id="POST-DELETE-BTN">삭제</span>
              </div>
            </div>
          </div>

          <!-- 스크랩 개수 -->
          <div id="DIV-SCRAP-COUNT">
            <span>스크랩</span>
            <span th:text="${post.scrapCount}" id="DIV-SCRAP"></span>
          </div>

          <!-- 본문 + 이미지 + 해시태그 -->
          <div id="DIV-POST-INFO-WRAP">
            <!-- 본문 -->
            <div id="DIV-POST-CONTENT" th:utext="${post.communityContent}"></div>

            <!-- 이미지 -->
            <div id="DIV-POST-IMAGE-WRAP" th:if="${!(post.Images).isEmpty()}">
              <!-- 메인 이미지 -->
              <div id="DIV-MAIN-IMAGE">
                <img src="" alt="mainImage">
              </div>
              <!-- 이미지 리스트 -->
              <div id="DIV-SUB-IMAGE-WRAP">
                <div class="div-sub-image" th:each="image : ${post.Images}">
                  <img th:src="@{'/' + ${image}}" alt="image" onclick="changeImage(this)">
                </div>
              </div>
            </div>

            <!-- 해시태그 -->
            <div id="DIV-POST-HASHTAG-WRAP" th:if="${!(post.tags).isEmpty()}">
              <div class="div-hashtag-wrap" th:each="tag : ${post.tags}"><span th:text="'#' + ${tag}"></span></div>
            </div>
          </div>
          <!--  -->

        </div>
        <!--  -->

        <!-- 프로필 영역 -->
        <div id="DIV-PROFILE-WRAP">
          <div id="DIV-USER-INFO-WRAP" class="div-go-user-page" th:data-user-id="${post.userId}">
            <div id="DIV-POST-USER-PROFILE">
              <img th:if="${post.profileImgUuid == null}" th:src="@{/image/layout/profile_img_basic.png}" alt="profile">
              <img th:unless="${post.profileImgUuid == null}" th:src="@{'/' + ${post.profileImgPath} + '/th_' + ${post.profileImgUuid}|}" alt="profile">
            </div>
            <div id="DIV-USER-WRAP">
              <div class="div-user-nick-age-wrap">
                <div class="div-nick" th:text="${post.userNickname}"></div>
                <div class="div-age" th:text="${post.userAge}"></div>
              </div>
              <div class="div-info" th:text="${post.userIntro}"></div>
            </div>
          </div>
          <div id="DIV-USER-FOLLOW-BTN" th:if="(${session.userId} != null) and (${post.userId} != ${session.userId.longValue()})">
            <button class="button-style basic-button" th:if="${post.isFollowed}" th:onclick="|noFollow(event, this, ${post.userId})|">팔로잉</button>
            <button class="button-style follow-btn" th:unless="${post.isFollowed}" th:onclick="|goFollow(event, this, ${post.userId})|">팔로우</button>
          </div>
          <div id="DIV-USER-FOLLOW-BTN" th:if="(${session.userId} == null)">
            <button class="button-style follow-btn" th:onclick="|goFollow(event, this, ${post.userId})|">팔로우</button>
          </div>
        </div>

      </div>
    </section>
    <!--  -->

    <!-- 목록 + 스크랩 버튼 영역 -->
    <section class="section-btn-wrap">
      <button class="button-style list-button" onclick="history.back()">목록으로</button>
      <button class="button-style basic-button" th:if="${post.isScrapped}" th:onclick="|noPostScrap(this, ${post.communityId})|">
        <img th:src="@{/image/community/scrap_white.png}">스크랩
      </button>
      <button class="button-style blue-line-button" th:unless="${post.isScrapped}" th:onclick="|goPostScrap(this, ${post.communityId})|">
        <img th:src="@{/image/layout/scrap_ok.png}">스크랩
      </button>
    </section>
    <!--  -->

    <!-- 댓글 영역 -->
    <section class="section-line">
      <!-- 댓글 입력 -->
      <div id="DIV-COMMENT-WRITE-WRAP">
        <form id="commentForm" method="post">
          <textarea name="commentContent" id="TEXTAREA-COMMENT-TXT" class="txt-comment-content" placeholder="댓글을 남겨주세요."></textarea>
          <div id="DIV-BTN-COUNT-WRAP">
            <div id="DIV-SAVE-BTN-WRAP">
              <div class="btn-comment-save">등록</div>
            </div>
            <div id="DIV-TEXT-COUNT">
              <span id="SPAN-COMMENT-COUNT">0</span>/200
            </div>
          </div>
        </form>
      </div>

      <!-- 댓글 목록 -->
      <div id="DIV-COMMENT-LIST-COUNT-WRAP">
        <div id="DIV-COMMENT-COUNT-WRAP">
          댓글 수 <span>83</span>
        </div>

        <!-- 댓글이 있을 경우 -->
        <div id="DIV-COMMENT-CONTAINER">
        
          <!-- 댓글 1개 -->
          <div class="div-comment-wrap div-parent-comment">
            <div class="div-comment-user-time-wrap">
              <div class="div-comment-user-profile-wrap" th:onclick="|location.href='@{}'|">
                <div class="div-comment-profile-wrap">
                  <img th:src="@{/image/example/profile_image/profile3.jpg}" alt="profile">
                </div>
                <div class="div-nick">작은식탁일기</div>
                <div class="div-age">30대</div>
              </div>
              <div class="div-comment-date time-ago" data-timestamp="2025-06-27T15:01:00"></div>
            </div>
            <div class="div-comment-content-wrap parent-comment-wrap">
              <div class="div-re-comment-btn-wrap">
                <div class="div-comment-content">
                  이런 글 보면 괜히 나도 글 쓰고 싶어져요. 하루하루 지나가는 순간들이 더 특별하게 느껴지네요.
                </div>
                <div class="div-re-comment-btn">
                  <img th:src="@{/image/community/re_comment_btn.png}">답글
                </div>
              </div>
              <div class="div-comment-btn-wrap">
                <div class="div-comment-btn div-menu-line"><span class="comment-update-btn">수정</span></div>
                <div class="div-comment-btn"><span class="comment-delete-btn">삭제</span></div>
              </div>
            </div>
          </div>
          <!--  -->
          
          <!-- 대댓글 1개 -->
          <div class="div-comment-wrap div-re-comment-wrap">
            <div class="div-comment-user-time-wrap">
              <div class="div-comment-user-profile-wrap" th:onclick="|location.href='@{}'|">
                <div class="div-comment-profile-wrap">
                  <img th:src="@{/image/example/profile_image/profile1.jpg}" alt="profile">
                </div>
                <div class="div-nick">침대밖은위험해</div>
                <div class="div-age">30대</div>
              </div>
              <div class="div-comment-date time-ago" data-timestamp="2025-06-27T15:01:00"></div>
            </div>
            <div class="div-comment-content-wrap child-comment-wrap">
              <div class="div-re-comment-btn-wrap">
                <div class="div-comment-content">
                  맞아요. 표현 너무 예뻐요…
                </div>
              </div>
              <div class="div-comment-btn-wrap">
                <div class="div-comment-btn div-menu-line"><span class="comment-update-btn">수정</span></div>
                <div class="div-comment-btn"><span class="comment-delete-btn">삭제</span></div>
              </div>
            </div>
          </div>
          <!--  -->
          
          <div class="div-comment-wrap div-parent-comment">
            <div class="div-comment-user-time-wrap">
              <div class="div-comment-user-profile-wrap">
                <div class="div-comment-profile-wrap" onclick="location.href=''">
                  <img src="/image/example/profile_image/profile3.jpg" alt="profile">
                </div>
                <div class="div-nick" onclick="location.href=''">작은식탁일기</div>
                <div class="div-age">30대</div>
              </div>
              <div class="div-comment-date time-ago" data-timestamp="2025-06-27T15:01:00"></div>
            </div>
            <div class="div-comment-content-wrap parent-comment-wrap">
              <div class="div-re-comment-btn-wrap">
                <div class="div-comment-content">사진도 글도 모두 예쁘네요. 감성적인 분위기 덕분에 하루의 끝에서 힐링하고 갑니다.<br>괜히 괜찮은 하루였다고 느껴지게 만드는 힘이 있어요.</div>
                <div class="div-re-comment-btn">
                  <img src="/image/community/re_comment_btn.png">답글
                </div>
              </div>
              <div class="div-comment-btn-wrap">
                <div class="div-comment-btn div-menu-line"><span class="comment-update-btn">수정</span></div>
                <div class="div-comment-btn"><span class="comment-delete-btn">삭제</span></div>
              </div>
            </div>
          </div>
          
          <!-- 댓글이 없을 경우 -->
          <!-- <div class="div-post-none">아직 작성된 댓글이 없습니다.<br>첫 댓글을 남겨주세요!</div> -->
          <!--  -->
        </div>

        <!-- 페이지네이션 -->
        <div id="DIV-PAGENATION-WRAP">
          <div class="div-page-btn-wrap">
            <div class="pagenation previous">◁</div>
          </div>
          <ul>
            <li class="pagenation page selected">1</li>
            <li class="pagenation page">2</li>
            <li class="pagenation page">3</li>
            <li class="pagenation page">4</li>
            <li class="pagenation page">5</li>
          </ul>
          <div class="div-page-btn-wrap">
            <div class="pagenation next">▷</div>
          </div>
        </div>
      </div>
    
    </section>
    <!--  -->
            
  </main>

  <!-- 하단 푸터 영역 -->
  <footer th:replace="layout/user-footer :: footerFragment"></footer>
  
  <!-- 알람 모달 -->
  <div th:replace="layout/modal :: modalFragment"></div>

</body>
</html>
